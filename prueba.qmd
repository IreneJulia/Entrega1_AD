---
title: "Entrega 1: Pingüinos"
author: "Irene LiFeng Julià Pérez y Xisco Ribera Ramis"
format: html
toc: true
editor: visual
---


```{r, warning=FALSE}
library(palmerpenguins)
datos <- penguins
```

**Con lo que sabéis de R base, realizad un análisis exploratorio de datos y redactad un reporte con los hallazgos más importantes. No olvidéis agregar en el reporte el URL de vuestro repositorio de GitHub.**


# Descripción de los datos


El data frame consta de 344 observaciones y 8 variables. Cada muestra representa un pingüino al que se le ha extraido la siguiente información:

- `species`: Especie (Adélie, Chinstrap y Gentoo)
- `island`: La isla a la que pertence (Biscoe, Dream o Torgersen)
- `bill_length_mm`: Longitud del pico (mm)
- `bill_depth_mm`: Ancho del pico (mm)
- `flipper_length_mm`: Longitud de la aleta (mm) 
- `body_mass_g`: Masa corporal (g)
- `sex`: sexo (macho o hembra)
- `year`: año en que se tomó la muestra

A continuación, mostramos un resumen cuantitativo del data frame:

```{r}
summary(datos)
head(datos)
```


Primero de todo, observemos que hay muestras que tienen valores desconocidos (NA), por tanto, vamos a eliminar dichas observaciones:


```{r}
datos = na.omit(datos)
summary(datos)
```


## Gráficos

A continuación, mostraremos algunas representaciones visuales que dan una información descriptiva de los datos.

### Diagramas de sectores

Realizamos un diagrama de sectores de las variables `species`, `island`, `sex` y `year`.

```{r echo=TRUE}
par(plt = c(0.1, 0.9, 0.1, 0.8))
par(mfrow=c(2,2))
pie(prop.table(table(datos$species)),col = hcl.colors(3, "Greens 3"), main = "Proporción de especies")
pie(prop.table(table(datos$island)),col = hcl.colors(3, "Blues 3"), main = "Proporción de cada isla")
pie(prop.table(table(datos$sex)), labels = c("Hembra", "Macho"), col = hcl.colors(3, "Fall"), main = "Sexo")
pie(prop.table(table(datos$year)),col = hcl.colors(3, "Mint"), main = "Año del experimento")
```





### Histogramas

A continuación, realizaremos unos histogramas de las variables `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm` y `body_mass_g` para ver a simple vista la distribución de la población.


```{r}
par(mfrow=c(2,2))
hist(datos$bill_length_mm, main='Longitud del pico (mm)', breaks = 30, col = 'lightblue',
     xlab = "Longitud pico", ylab = "Frecuencia")
hist(datos$bill_depth_mm, main='Anchura del pico (mm)', breaks = 35, col = 'coral3',
     xlab = "Ancho pico", ylab = "Frecuencia")
hist(datos$flipper_length_mm, main='Longitud de la aleta (mm)', breaks = 30, col = 'lightgreen', xlab = "Longitud aleta", ylab = "Frecuencia")
hist(datos$body_mass_g, main='Masa Corporal (g)', breaks = 30, col = 'pink',
     xlab = "Masa corporal", ylab = "Frecuencia")
```





# Medias muestrales de las variable en función de cada especie

Comparemos las medias de las variables cuantitativas en función de cada especie, que corresponden con las características físicas de cada pingüino.

Para ello, dividamos el data frame por especies:

```{r}
ping_adelie = datos[datos$species=="Adelie",]
ping_chinstrap = datos[datos$species=="Chinstrap",]
ping_gentoo = datos[datos$species=="Gentoo",]
```


## Longitud del pico

Veamos la media de la longitud del pico de cada especie

```{r}
mean(ping_adelie$bill_length_mm)
mean(ping_chinstrap$bill_length_mm)
mean(ping_gentoo$bill_length_mm)
```

Notemos que los pinguinos de especie `Adelie` de media tienen el pico mas corto que las otras dos especies.


```{r, echo=FALSE}
boxplot(bill_length_mm ~ species, data = datos,
        xlab = "", ylab = "Longitud pico (mm)",
        main = "Longitud del pico por especie", col = hcl.colors(4, "Peach"), cex.axis=0.85)
medias = c(mean(ping_adelie$bill_length_mm), mean(ping_chinstrap$bill_length_mm), 
                  mean(ping_gentoo$bill_length_mm))
# añadimos medias
points(x = 1:length(medias), y = medias, pch = 19, col = "red")
text(x = 1:length(medias), y = medias, labels = round(medias, 3), pos = 1, cex = 0.7,
     col = "white")
```

## Ancho del pico

```{r}
mean(ping_adelie$bill_depth_mm)
mean(ping_chinstrap$bill_depth_mm)
mean(ping_gentoo$bill_depth_mm)
```

Notemos que los pinguinos de especie `Gentoo` de media tienen el pico menos ancho que las otras dos especies.

```{r, echo=FALSE}
boxplot(bill_depth_mm ~ species, data = datos,
        xlab = "", ylab = "Ancho pico (mm)",
        main = "Ancho del pico por especie", col = hcl.colors(4, "Peach"), cex.axis=0.85)
medias = c(mean(ping_adelie$bill_depth_mm), mean(ping_chinstrap$bill_depth_mm), 
                  mean(ping_gentoo$bill_depth_mm))
# añadimos medias
points(x = 1:length(medias), y = medias, pch = 19, col = "red")
text(x = 1:length(medias), y = medias, labels = round(medias, 3), pos = 1, cex = 0.7,
     col = "white")
```



## Longitud de la aleta

```{r}
mean(ping_adelie$flipper_length_mm)
mean(ping_chinstrap$flipper_length_mm)
mean(ping_gentoo$flipper_length_mm)
```

Notemos que los pinguinos de especie `Gentoo` de media tienen la aleta más larga que las otras dos especies.

```{r, echo=FALSE}
boxplot(flipper_length_mm ~ species, data = datos,
        xlab = "", ylab = "Longitud aleta (mm)",
        main = "Longitud de la aleta por especie", col = hcl.colors(4, "Peach"), cex.axis=0.85)
medias = c(mean(ping_adelie$flipper_length_mm), mean(ping_chinstrap$flipper_length_mm), 
                  mean(ping_gentoo$flipper_length_mm))
# añadimos medias
points(x = 1:length(medias), y = medias, pch = 19, col = "red")
text(x = 1:length(medias), y = medias, labels = round(medias, 3), pos = 1, cex = 0.7,
     col = "white")
```



## Masa corporal

```{r}
mean(ping_adelie$body_mass_g)
mean(ping_chinstrap$body_mass_g)
mean(ping_gentoo$body_mass_g)
```

Notemos que los pinguinos de especie `Gentoo` de media tienen mas masa corporal que las otras dos especies. Y como hemos visto en el apartado de correlación, seguramente se debe a que la especie `Gentoo` es más grande que las otras dos.


```{r, echo=FALSE}
boxplot(body_mass_g ~ species, data = datos,
        xlab = "", ylab = "Masa corporal (g)",
        main = "Masa corporal por especie", col = hcl.colors(4, "Peach"), cex.axis=0.85)
medias = c(mean(ping_adelie$body_mass_g), mean(ping_chinstrap$body_mass_g), 
                  mean(ping_gentoo$body_mass_g))
# añadimos medias
points(x = 1:length(medias), y = medias, pch = 19, col = "red")
text(x = 1:length(medias), y = medias, labels = round(medias, 3), pos = 1, cex = 0.7,
     col = "white")
```



# Correlación de las variables

Veamos si existe correlación, tanto positiva como negativa de las variables numéricas. Para ello, mostraremos una matriz de correlaciones.


```{r, warning=FALSE}
library(psych)
datos2 = datos[,c(-1,-2,-7,-8)] # eliminamos las variables no numéricas
nombres = c("Longitud pico", "Ancho pico", "Longitud aleta", "Masa corporal")
corPlot(datos2, cex = 0.8,  main = "Matriz de correlación", labels = nombres)
```

Cabe destacar la correlación fuerte positiva (valor de +0.87) entre la masa corporal y la longitud de las alas de los pingüinos, es decir, a mayor masa corporal, mayor longitud de alas, lo que da a pensar que si hay una especie que tenga, en general, mayor peso, será porque el animal es más grande.

También hay correlación moderadamente fuerte positiva (valores de +0.59 y +0.65) entre la longitud del pico y la masa corporal, y la longitud del pico y la longitud de la aleta.

Por otro lado, se presenta una correlación moderadamente fuerte negativa (-0.58) entre la longitud de la aleta y el ancho del pico, es decir, cuanto más larga es la aleta, menos ancho el pico y viceversa.


# Comparaciones geográficas

Una vez hemos estudiado las medias de los valores cuantitativos de las características de los pingüinos, podemos ver si hay diferencias entre islas.

PENSAR BÉ COM ENFOCAR-HO, ES A DIR, SERIA INTERESSANT VEURE QUINES DADES TENEN MAJOR DISPERSIÓ PER ESTUDIAR SI AFECTA GEOGRAFICAMENT, IE, IMAGINA QUE SURT QUE ES PINGÜINOS GENTOO TENEN ES BEC MES LLARG I A MES MOSTREN DISPERSIO EN SES DADES, PUES POT SER QUE A UNA ILLA, PER ES TIPUS DE MENJAR, TENGUIN ES BEC MES LLARG O MES CURT I FACI ALTERAR SA MITJANA





**Nota:** las conclusiones extraidas sobre las medias no pueden extrapolarse a toda la población.
